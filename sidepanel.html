<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <link rel="stylesheet" href="sidepanel.css?v=1">
</head>
<body>
  <div id="container">
    <!-- Header -->
    <div id="mollitiam-header">
      <div class="header-brand">
        <img src="icons/icon-48.png" alt="Mollitiam" class="mollitiam-logo">
        <h2 class="mollitiam-title">Mollitiam</h2>
      </div>
      <span class="header-tagline">Accessibility &bull; AI &bull; Hands-Free</span>
    </div>

    <!-- Tab Navigation -->
    <div class="tab-nav">
      <button class="tab-btn active" data-tab="accessibility">
        <span class="tab-icon">&#9855;</span>
        <span class="tab-label">Accessibility</span>
      </button>
      <button class="tab-btn" data-tab="summarize">
        <span class="tab-icon">&#129302;</span>
        <span class="tab-label">AI Summary</span>
      </button>
      <button class="tab-btn" data-tab="tracking">
        <span class="tab-icon">&#127919;</span>
        <span class="tab-label">Tracking</span>
      </button>
    </div>

    <!-- ==================== TAB: Accessibility ==================== -->
    <div class="tab-content active" id="tab-accessibility">
      
      <!-- Simplify Text Section -->
      <div class="card">
        <h3 class="card-title">
          <span class="card-icon">&#10024;</span>
          Text Simplification
        </h3>
        
        <div class="setting-group">
          <label class="setting-label">Simplification Level</label>
          <div class="level-buttons">
            <button class="level-btn" data-level="1">Low</button>
            <button class="level-btn selected" data-level="3">Mid</button>
            <button class="level-btn" data-level="5">High</button>
          </div>
          <p class="help-text">Higher levels use simpler language</p>
        </div>

        <div class="setting-group">
          <label class="setting-label" for="optimize-mode">Optimization Mode</label>
          <select id="optimize-mode" class="setting-select">
            <option value="textClarity" selected>Text Clarity</option>
            <option value="focusStructure">Focus &amp; Structure (ADHD)</option>
            <option value="wordPattern">Word Patterns (Dyslexia)</option>
          </select>
        </div>

        <button id="simplify-btn" class="btn primary full-width">
          Simplify Page Text
        </button>
      </div>

      <!-- Visual Accessibility -->
      <div class="card">
        <h3 class="card-title">
          <span class="card-icon">&#127912;</span>
          Visual Settings
        </h3>

        <div class="setting-group">
          <label class="toggle-container">
            <input type="checkbox" id="font-toggle">
            <span class="toggle-slider"></span>
            <span class="toggle-label">OpenDyslexic Font</span>
          </label>
        </div>

        <div class="setting-group">
          <label class="toggle-container">
            <input type="checkbox" id="hover-toggle">
            <span class="toggle-slider"></span>
            <span class="toggle-label">Show Original on Hover</span>
          </label>
          <p class="help-text">Hover simplified text to see original</p>
        </div>

        <div class="setting-group">
          <label class="setting-label" for="theme-select">Color Theme</label>
          <select id="theme-select" class="setting-select">
            <option value="default">Default</option>
            <option value="highContrast">High Contrast</option>
            <option value="highContrastAlt">High Contrast (Dark)</option>
            <option value="darkMode">Dark Mode</option>
            <option value="sepia">Sepia</option>
            <option value="lowBlueLight">Low Blue Light</option>
            <option value="softPastelBlue">Soft Blue</option>
            <option value="softPastelGreen">Soft Green</option>
            <option value="creamPaper">Cream Paper</option>
            <option value="grayScale">Grayscale</option>
            <option value="blueLightFilter">Blue Light Filter</option>
            <option value="highContrastYellowBlack">Yellow on Black</option>
            <option value="highContrastBlackYellow">Black on Yellow</option>
          </select>
        </div>
      </div>

      <!-- Spacing Controls -->
      <div class="card">
        <h3 class="card-title">
          <span class="card-icon">&#8596;&#65039;</span>
          Spacing
        </h3>

        <div class="setting-group">
          <label class="setting-label">
            Line Spacing: <span id="line-spacing-value">1.5</span>
          </label>
          <input type="range" id="line-spacing" min="1" max="3" step="0.1" value="1.5" class="slider">
        </div>

        <div class="setting-group">
          <label class="setting-label">
            Letter Spacing: <span id="letter-spacing-value">0</span>px
          </label>
          <input type="range" id="letter-spacing" min="0" max="5" step="0.5" value="0" class="slider">
        </div>

        <div class="setting-group">
          <label class="setting-label">
            Word Spacing: <span id="word-spacing-value">0</span>px
          </label>
          <input type="range" id="word-spacing" min="0" max="10" step="1" value="0" class="slider">
        </div>

        <button id="reset-spacing" class="btn secondary full-width">Reset to Defaults</button>
      </div>
    </div>

    <!-- ==================== TAB: AI Summary ==================== -->
    <div class="tab-content" id="tab-summarize">
      
      <div class="card">
        <h3 class="card-title">
          <span class="card-icon">&#9881;&#65039;</span>
          Summarization Settings
        </h3>

        <div class="setting-group">
          <label class="setting-label" for="display-mode">Display Location</label>
          <select id="display-mode" class="setting-select">
            <option value="tooltip" selected>Tooltip Only</option>
            <option value="panel">Side Panel Only</option>
          </select>
        </div>
        
        <div class="radio-group">
          <label>
            <input type="radio" name="api-choice" value="summarization" id="radio-summarization" checked>
            <span>Summarization API</span>
          </label>
          <label>
            <input type="radio" name="api-choice" value="prompt" id="radio-prompt">
            <span>Prompt API (Custom)</span>
          </label>
        </div>
        
        <div id="prompt-container" class="hidden">
          <label class="setting-label" for="custom-prompt">Custom Prompt</label>
          <textarea id="custom-prompt" rows="3" placeholder="Enter your summarization prompt...">Summarize this article in 2-3 sentences</textarea>
        </div>
      </div>

      <!-- Loading States -->
      <div id="loading-extract" class="hidden">
        <div class="loading-state">
          <div class="spinner"></div>
          <p>Extracting content...</p>
        </div>
      </div>
      
      <div id="loading-summarize" class="hidden">
        <div class="loading-state">
          <div class="spinner"></div>
          <p>Generating summary...</p>
        </div>
      </div>
      
      <!-- Content Area -->
      <div id="content-area" class="hidden">
        <h1 id="title"></h1>
        
        <div id="summary-section">
          <h2 class="section-heading">AI Summary</h2>
          <div id="ai-summary"></div>
        </div>
        
        <button id="toggle-full-content" class="btn secondary full-width">View Full Content</button>
        
        <div id="full-content-section" class="hidden">
          <h2 class="section-heading">Full Content</h2>
          <div id="article-content"></div>
        </div>
      </div>
      
      <!-- Error State -->
      <div id="error" class="hidden">
        <div class="error-card">
          <p id="error-message"></p>
        </div>
        <div id="fallback-content" class="hidden">
          <h2 class="section-heading">Full Content (Fallback)</h2>
          <h1 id="fallback-title"></h1>
          <div id="fallback-article"></div>
        </div>
      </div>

      <!-- Welcome State -->
      <div id="welcome">
        <div class="welcome-content">
          <div class="welcome-icon">&#128170;</div>
          <p>Hover over any link to get an AI summary, or switch to the Accessibility tab to simplify page text!</p>
        </div>
      </div>
    </div>

    <!-- ==================== TAB: Head Tracking ==================== -->
    <div class="tab-content" id="tab-tracking">
      
      <!-- Head Tracking -->
      <div class="card">
        <h3 class="card-title">
          <span class="card-icon">&#127919;</span>
          Head Tracking (Hands-Free)
        </h3>

        <div class="setting-group">
          <label class="toggle-container">
            <input type="checkbox" id="gaze-enabled" checked>
            <span class="toggle-slider"></span>
            <span class="toggle-label">Enable Head Tracking</span>
          </label>
          <p class="help-text">Requires camera access for head movement detection</p>
        </div>

        <div class="status-indicator">
          <span class="status-dot" id="gaze-status-dot"></span>
          <span id="gaze-status-text">Disabled</span>
        </div>

        <button id="calibrate-btn" class="btn secondary full-width">
          Calibrate Head Position
        </button>

        <div class="setting-group">
          <label class="setting-label">
            Dwell Time: <span id="dwell-value">600</span>ms
          </label>
          <input type="range" id="dwell-time" min="300" max="1200" step="50" value="600" class="slider">
          <p class="help-text">Time to hover before clicking a link</p>
        </div>
      </div>

      <!-- Mouth Click -->
      <div class="card">
        <h3 class="card-title">
          <span class="card-icon">&#128068;</span>
          Mouth Click (Optional)
        </h3>

        <div class="setting-group">
          <label class="toggle-container">
            <input type="checkbox" id="mouth-click-enabled">
            <span class="toggle-slider"></span>
            <span class="toggle-label">Enable Mouth Click</span>
          </label>
          <p class="help-text">Open your mouth wide to trigger clicks</p>
        </div>

        <div class="status-indicator">
          <span class="status-dot" id="mouth-status-dot"></span>
          <span id="mouth-status-text">Not calibrated</span>
        </div>

        <button id="calibrate-mouth-btn" class="btn secondary full-width">
          Calibrate Mouth Click
        </button>
      </div>

      <!-- Keyboard Shortcuts -->
      <div class="card">
        <details class="keyboard-shortcuts">
          <summary>Keyboard Shortcuts</summary>
          <ul>
            <li><kbd>Alt+H</kbd> <span>Calibrate head tracking</span></li>
            <li><kbd>Alt+M</kbd> <span>Calibrate mouth click</span></li>
            <li><kbd>Alt+P</kbd> <span>Toggle pointer visibility</span></li>
            <li><kbd>Alt+V</kbd> <span>Toggle camera preview</span></li>
            <li><kbd>Shift+H</kbd> <span>Toggle debug HUD</span></li>
          </ul>
        </details>
      </div>
    </div>
  </div>
  
  <script src="sidepanel.js?v=1"></script>
</body>
</html>
